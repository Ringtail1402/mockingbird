Anthem
======

Anthem is a lightweight PHP 5.3 web framework, building and expanding on
Silex microframework, Propel ORM engine and Bootstrap for front-end.
Anthem was partially inspired by Symfony (1.x version more
than 2.x).  Anthem provides tools for building real-world web apps,
while at the same time designed to be as simple as possible.

As of now, Anthem is very incomplete.  It was written mostly as an
exercise.  Symfony 2 is great, use it instead.


Features
========

* All Silex and Propel features
* PHP/JS/CSS code organization in modules
* Trivial configuration hierarcy
* Front controllers
* Console and Cron tasks
* Multi-language support
* Templating engine based on plain PHP files, supports
  template overrides and helpers
* Propel model/SQL generation wrapped in a single command
* Database fixtures
* Lightweight form/input/validation library
* Back-end interface based on Bootstrap framework, supporting:
  - 100% AJAX interface, very responsive
  - Hash navigation within a single admin page
  - Arbitrary data sorting and filtering
  - Arbitrary user-defined column types, which might not necessarily
    map on actual Propel object properties
  - Usually only little configuration is necessary
  - Simple menu for back-end navigation
* App-wide settings engine with UI
* Transient and persistent user notifications
* Scripted tours facilitating feature discovery by users.


Installation
============

Anthem application will generally have the following structure:

  /
  +- Anthem/
  |  +- Core/
  |  +- Forms/
  |  +- ...
  +- Module1/
  +- Module2/
  +- ...
  +- SQL/
  +- App.php (optional)
  +- localconfig.inc

Anthem directory holds default Anthem modules.  Other modules may be
installed separately.

SQL directory will hold SQL schemas generated by `propel:build` or
`propel:build-sql` console tasks.  It is generated automatically.  You may
remove it at any moment.

`App.php` file, if present, must contain `App` class deriving from `Module`; this
allows writing application-wide code.  This is only a convenience; you may
put all your code in modules, if desired.

`localconfig.inc` will contain admin-configurable options, such as database
credentials.  It must always define `modules` option, which contains a list
of app modules in order of loading.

The entire app directory should not be directly accessible from the Web.
Use `bootstrap.php` script to create app entry points and symlinks to static
resources in web server directory:

  $ php /path/to/app/Anthem/bootstrap.php /var/www/myapp

This will create four entry points (front controllers): `index.php`,
`index.debug.php`, `console.php` and `console.debug.php`.  On production systems,
`index.debug.php` should be removed or modified to limit access, and
`index.php` should be hidden from the URL through URL rewriting.
`console.php`/`console.debug.php` provide interfaces for console tasks,
which may be then run as `php console.php module:task args...`.
It is safe to leave `console.php/console.debug.php` in web server dir.


Modules
=======

Anthem basic modules are designed to function together, although specific
features (e.g. user authentication) may be disabled through config.
Modules which provide content management functions go in AnthemCM library.

Core
----

Core module must always be present, and initialized first.  It provides the
following functions:

* Silex, jQuery, Bootstrap libraries;
* Application bootstrapping classes (`Anthem/Core/Main/*`), directly used by
  front controllers;
* CLI task infrastructure (`Anthem/Core/Task/*`);
* PHP templating engine and basic helpers (`Anthem/Core/View/*`);
* L10n infrastructure.

Highlights:

* When bootstrapping, configuration files `config.inc` are read and executed
  from each module dir and then from app root dir.  These files generate
  `$config` array.  Config options for each module should be kept under
  `$config['Module']`.  Modules initialized later may override or add to config
  options of modules initialized earlier. `config.inc` files are for
  configuration by app developer, rather than app administrator.
  For admin-configurable settings they should use `$localconfig` values.
* Derive all your modules from dummy `Anthem/Core/Module` class.
  Implement `Silex\ServiceProviderInterface` to provide general-purpose code and
  `Silex\ControllerProviderInterface` to provide some routes.
* Implement `Anthem/Core/TaskProviderInterface` in a module if you want it
  to have some CLI tasks.
* Implement `Anthem/View/HelperProviderInterface` in a module if you want it
  to have some custom helpers.
* Custom view engines (e.g. twig) may be added, although this feature
  is untested.
* Call `$app['core.view']->render('Module:template.php, array('param1' => $param1, ...))`
  to render a template.  Template must be specified in `module:path` format.
  Module templates are stored in Templates directory of that module, but can
  be overridden at the app level by creating `Templates/Module/template.php` file
  in app root.
* In a template, call `$asset->js('Module:script.js')` to get real path to
  a Javascript.  Path scheme is similar to templates; Javascripts are stored
  in modules `JS` dir.  Same with `$asset->css()`, `$asset->image()`.
* In a template, call `$link->url('route', array('param1' => $param1, ...))`
  to generate an URL to a route.

Cron
----

Provides unified interface for running cron tasks.  Modules implementing
cron tasks must implement `Anthem/Cron/CronProviderInterface`.  Add
`php console.php cron:hourly`, `php console.php cron:daily`,
`php console.php cron:weekly`, `php console.php cron:monthly` to your crontab
at appropriate intervals.

Propel
------

Wraps Propel ORM:

* Packages Propel runtime into a .phar archive, so that Anthem apps do not
  require Propel to be installed system-wide, but do not pollute filesystem
  with hundreds of Propel classes.
* Initializes Propel on app start.
* Provides console tasks `propel:build*` wrapping `propel-gen` script.
* Provides database fixtures feature.  Modules implementing
  `Anthem/Propel/Fixtures/FixtureProviderInterface` can load data and
  generally perform arbitrary database operations on `propel:load-fixtures`.
* Provides base `PropelModelService` class, wrapping Propel operations.  Apps should
  generally keep their Propel-dependent code in `PropelModelService` classes, and
  leave model/peer/query classes as stubs.

Modules which require their own Propel models must have a `schema.xml`
file in module root.  This is a regular Propel schema file, see e.g.
`Settings` module for a trivial `schema.xml`.  Auto-generated classes should
go in `Model` dir of the module.

Forms
-----

Provides a lightweight form framework.  Its components are input classes,
validator classes, and base `Form` class.

Admin
-----

Back-end UI framework, probably the largest part of Anthem at the moment.

Notify
------

Notifications library.

Settings
--------

App-wide settings library.

